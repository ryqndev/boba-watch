"use strict";(self.webpackChunkboba_watch=self.webpackChunkboba_watch||[]).push([[609],{3798:function(e,t,a){function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var a=parseInt(e/100);return isNaN(a)?"---":a}var s=Number(e/100).toFixed(2);return isNaN(s)?"---":s}a.d(t,{K:function(){return s}})},4609:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var s=a(1413),n=a(885),l=a(2791),i=a(8182),r=a(3168),c=a(7595),o=a(5429),d=a(3798),h=a(4796),m=a(5135),u=a(6871),p=a(910),x=a(4674),j=a(1951),f=a(1956),v=a(9201),N=a(184),g=function(e){var t=e.data,a=e.triggerUpdate,i=e.theme,g=(0,l.useContext)(x.Z),b=(0,n.Z)(g,1)[0],_=(0,r.$)(),y=_.i18n,Z=_.t,S=(0,l.useState)(!1),k=(0,n.Z)(S,2),w=k[0],M=k[1],H=(0,u.s0)(),C=new Date(t.date);return(0,N.jsxs)("div",{className:"drink-panel",children:[(0,N.jsxs)("div",{className:"info",onClick:function(){M(!w)},children:[(0,N.jsx)("p",{className:"place",children:t.location}),(0,N.jsxs)("p",{className:"price",children:[Z("$"),(0,d.K)(t.price)]}),(0,N.jsx)("div",{className:"expand-icon",children:w?(0,N.jsx)(c.Z,{}):(0,N.jsx)(o.Z,{})}),(0,N.jsx)("p",{className:"name",children:t.name}),(0,N.jsx)("p",{className:"time",children:(0,j.Z)(C,"M/dd h:mm a",{locale:"zh-TW"===y.language?f.Z:v.Z})})]}),(0,N.jsxs)("div",{className:"collapsed-info"+(w?" expanded":""),children:[(0,N.jsx)(E,(0,s.Z)((0,s.Z)({},t),{},{theme:i,expanded:w,date:C})),(0,N.jsxs)("div",{className:"options",children:[(0,N.jsx)("button",{className:"text",onClick:function(){H("/edit/"+t.id)},children:Z("EDIT")}),(0,N.jsx)("button",{className:"text",onClick:function(){m.Fs.collection("users/".concat(b.uid,"/drinks")).doc(t.id).delete().then((function(){var e=(0,h.Tq)(t.id);e.d=JSON.stringify(e.d),m.Fs.collection("users/".concat(b.uid,"/user")).doc("stats").set(e).finally((function(){(0,p.b7)(),a(JSON.parse(localStorage.getItem("drinkids")))}))})).catch((function(e){(0,p.bI)(e)}))},children:Z("DELETE")})]})]})]})},b=(0,l.memo)(g),_=a(5861),y=a(7757),Z=a.n(y),S=a(5613),k=a(6433),w=a(500),M=function(e){var t=e.name,a=e.location,s=e.description,i=e.theme,c=e.expanded,o=e.address,d=e.image,h=e.date,m=(0,r.$)().t,u=(0,l.useState)(!1),p=(0,n.Z)(u,2),x=p[0],j=p[1];return(0,l.useEffect)((function(){c&&d&&(0,_.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=j,e.next=3,(0,S.Vq)(d);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))()}),[d,c]),(0,N.jsxs)("div",{className:"expanded-drink-description--wrapper",children:[o&&(0,N.jsx)(k.D5,{className:"map",theme:i,scrollWheelZoom:!1,hasCenterButton:!1,zoom:10,center:[o.lat,o.lng],children:(0,N.jsx)(w.c,{center:[o.lat,o.lng],radius:10,fill:!0,weight:1,color:"#F68080",fillColor:"#F68080",fillOpacity:"0.5"})}),(0,N.jsxs)("p",{className:"title",children:[t,(0,N.jsx)("br",{}),(0,N.jsxs)("span",{children:["@",a]})]}),x&&(0,N.jsx)("img",{src:x,className:"user-uploaded",alt:"user-upload"}),(0,N.jsx)("br",{}),(0,N.jsx)("div",{className:"description",children:(0,N.jsx)(k.sf,{card:!1,description:s})}),(0,N.jsx)("br",{}),(0,N.jsxs)("p",{className:"date",children:[(0,N.jsx)("span",{children:m("on")})," ",h.toString()]})]})},E=(0,l.memo)(M),H={container:"MobileHistory_container__fZs88",title:"MobileHistory_title__DgEAm",header:"MobileHistory_header__Xz8gi",search:"MobileHistory_search__usHUq",history:"MobileHistory_history__WcUxY",bw:"MobileHistory_bw__Zc9AP",total:"MobileHistory_total__o4yXi","none-label":"MobileHistory_none-label__Hyic6","load-more":"MobileHistory_load-more__X7z5n","thaman-color":"MobileHistory_thaman-color__-j+SU"},C=function(e){var t=e.click;return(0,N.jsx)("div",{className:H["thaman-color"],children:(0,N.jsx)("div",{className:H["load-more"],onClick:t,children:"\u2022 \u2022 \u2022"})})},D=function(e){var t=e.label,a=(0,r.$)().t;return(0,N.jsx)("div",{className:(0,i.default)(H["thaman-color"],H["none-label"]),children:(0,N.jsx)("h3",{className:(0,i.default)(H.bw,H["none-label"]),children:a(t)})})},I=function(e){var t=e.theme,a=(0,r.$)().t,c=(0,l.useState)([]),o=(0,n.Z)(c,2),h=o[0],m=o[1],u=(0,l.useState)([]),p=(0,n.Z)(u,2),x=p[0],j=p[1],f=(0,l.useState)({complete:5,recent:7}),v=(0,n.Z)(f,2),g=v[0],_=v[1],y=(0,l.useState)([]),Z=(0,n.Z)(y,2),S=Z[0],w=Z[1],M=(0,l.useState)(JSON.parse(localStorage.getItem("drinkids"))),E=(0,n.Z)(M,2),I=E[0],O=E[1],q=(0,l.useState)(JSON.parse(localStorage.getItem("metrics"))),F=(0,n.Z)(q,2),U=F[0],$=F[1];(0,l.useEffect)((function(){$(JSON.parse(localStorage.getItem("metrics")));var e=[],a=[],n=[],l=new Date,i=l.getMonth(),r=l.getFullYear(),c=g.complete,o=g.recent;I.forEach((function(s){var l=JSON.parse(localStorage.getItem(s));n.push(l);var d=new Date(l.date),h=d.getMonth()===i&&d.getFullYear()===r;h&&o>0?(e.push((0,N.jsx)(b,{theme:t,triggerUpdate:O,data:l},l.id)),o--):!h&&c>0&&(a.push((0,N.jsx)(b,{theme:t,triggerUpdate:O,data:l},l.id)),c--)})),0===e.length&&(e.push((0,N.jsx)(D,{label:"no drinks this month ...yet"},"@ryqndev/empty")),0===a.length&&a.push((0,N.jsx)(D,{label:"Add a drink to start!"},"@ryqndev/empty"))),o<=0&&e.push((0,N.jsx)(C,{click:function(){_((0,s.Z)((0,s.Z)({},g),{},{recent:g.recent+10}))}},"@ryqndev/load")),c<=0&&a.push((0,N.jsx)(C,{click:function(){_((0,s.Z)((0,s.Z)({},g),{},{complete:g.complete+10}))}},"@ryqndev/load")),m(e),j(a),w(n)}),[I.length,t,I,g,g.recent,g.complete]);return(0,N.jsx)("div",{className:"page with-user",children:(0,N.jsxs)("div",{className:H.container,children:[(0,N.jsx)("div",{className:H.header,children:(0,N.jsx)("h3",{className:H.title,children:a("history")})}),(0,N.jsx)("div",{className:H.search,children:(0,N.jsx)(k.wD,{data:S,keys:["description","location","name","price"],Result:function(e){var a=e.item;e.matches;return(0,N.jsx)(b,{theme:t,triggerUpdate:O,data:a})}})}),(0,N.jsxs)("div",{className:H.list,children:[(0,N.jsx)("h3",{className:H.bw,children:a("Monthly Spending")}),(0,N.jsx)("div",{className:"history-spending",children:h}),(0,N.jsxs)("h3",{className:(0,i.default)(H.bw,H.total),children:[(0,N.jsxs)("span",{children:[a("Monthly Total"),":"]})," ",a("$"),(0,d.K)(U.tc)]}),(0,N.jsx)("h3",{className:H.bw,children:a("Overall Spending")}),(0,N.jsx)("div",{className:"history-spending",children:x}),(0,N.jsxs)("h3",{className:(0,i.default)(H.bw,H.total),children:[(0,N.jsxs)("span",{children:[a("Complete Total"),":"]})," ",a("$"),(0,d.K)(U.ctc)]})]})]})})},O=(0,l.memo)(I)},5429:function(e,t,a){var s=a(5318),n=a(862);t.Z=void 0;var l=n(a(2791)),i=(0,s(a(4894)).default)(l.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");t.Z=i},7595:function(e,t,a){var s=a(5318),n=a(862);t.Z=void 0;var l=n(a(2791)),i=(0,s(a(4894)).default)(l.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");t.Z=i}}]);
//# sourceMappingURL=609.3e1c6d0a.chunk.js.map